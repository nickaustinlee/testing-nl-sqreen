/**
 * Copyright (c) 2016 - 2020 Sqreen. All Rights Reserved.
 * Please refer to our terms for more information: https://www.sqreen.io/terms.html
 */
'use strict';
const Code = require('code');
const Lab = require('lab');
const lab = exports.lab = Lab.script();

const describe = lab.describe;
const it = lab.it;
const expect = Code.expect;

const Capture = require('../../../../lib/rules/rules-callback/captureCB');

describe('Capture CB', () => {

    it('should collect what it has to', { plan: 1 }, (done) => {

        const cb = Capture.getCbs({ data: { values: [{ capture: [{ ba: '#.inst[\'a\']', as: 'a' }, { ba: '#.inst[\'b\']', as: 'b' }, { ba: '#.inst[\'b\'][\'a\']', as: 'c' }] }] } });

        const res = cb.pre(null, null, null, { a: 1 }, {});

        expect(res.data_points).to.equal([{ a: 1, b: undefined, c: '' }]);
        done();
    });
});
